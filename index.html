<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GCSE Study ‚Äì English & Science</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#05010b" />
  <style>
    :root {
      --bg: #05010b;
      --panel: #090317;
      --panel-soft: #0b041b;
      --border: #26163b;
      --accent: #ec4899;
      --accent-soft: rgba(236, 72, 153, 0.16);
      --accent-strong: #f97316;
      --text: #f9fafb;
      --muted: #9ca3af;
      --radius-lg: 18px;
      --radius-md: 12px;
      --shadow: 0 20px 40px rgba(0, 0, 0, 0.9);
      --fast: 0.12s ease-out;
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #160322 0, #05010b 45%, #020009 100%);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      display: flex;
      flex-direction: column;
    }

    @keyframes floatUp {
      from { opacity: 0; transform: translateY(6px) scale(0.99); }
      to   { opacity: 1; transform: translateY(0) scale(1); }
    }

    @keyframes fadeInView {
      from { opacity: 0; transform: translateY(4px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* HEADER */

    .app-header {
      position: sticky;
      top: 0;
      z-index: 20;
      padding-top: env(safe-area-inset-top);
      background: rgba(5, 1, 11, 0.98);
      backdrop-filter: blur(18px);
      border-bottom: 1px solid rgba(148, 27, 84, 0.45);
    }

    .app-header-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 10px 14px 8px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .header-row-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .brand-block {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-dot {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #fee2e2 0, #ec4899 40%, #4c1d95 80%);
      box-shadow:
        0 0 20px rgba(236, 72, 153, 0.9),
        0 0 34px rgba(147, 51, 234, 0.8);
    }

    .brand-text-main {
      font-size: 17px;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.18em;
    }

    .brand-text-sub {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.14em;
    }

    .header-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
      flex-shrink: 0;
    }

    .subject-toggle {
      display: flex;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 2px;
      gap: 2px;
    }

    .subject-btn {
      border: none;
      border-radius: 999px;
      padding: 4px 9px;
      font-size: 11px;
      color: var(--muted);
      background: transparent;
      cursor: pointer;
      transition: background var(--fast), color var(--fast), transform var(--fast);
    }

    .subject-btn.active {
      background: var(--accent-soft);
      color: var(--text);
      transform: translateY(-1px);
    }

    .theme-select-wrap {
      display: flex;
      flex-direction: column;
      gap: 2px;
      font-size: 11px;
      color: var(--muted);
    }

    .theme-select-wrap select {
      background: rgba(15, 23, 42, 0.96);
      color: var(--text);
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 5px 9px;
      font-size: 11px;
      outline: none;
      transition: border var(--fast), box-shadow var(--fast), background var(--fast), transform var(--fast);
    }

    .theme-select-wrap select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent);
      background: #020013;
      transform: translateY(-1px);
    }

    .header-row-search {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .search-bar {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 7px 11px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(148, 163, 184, 0.7);
    }

    .search-bar span {
      font-size: 15px;
      opacity: 0.8;
    }

    .search-bar input {
      border: none;
      background: transparent;
      color: #e5e7eb;
      font-size: 13px;
      outline: none;
      width: 100%;
    }

    .search-bar input::placeholder {
      color: rgba(148, 163, 184, 0.9);
    }

    .search-button {
      border-radius: 999px;
      border: none;
      background: #3b82f6;
      color: #eff6ff;
      font-size: 12px;
      padding: 7px 11px;
      font-weight: 600;
      cursor: pointer;
      flex-shrink: 0;
      box-shadow: 0 8px 20px rgba(37, 99, 235, 0.9);
      transition: transform var(--fast), box-shadow var(--fast), opacity var(--fast);
    }

    .search-button:active {
      transform: translateY(1px);
      box-shadow: none;
      opacity: 0.95;
    }

    main {
      flex: 1;
      display: flex;
      justify-content: center;
      padding: 10px 14px 72px;
    }

    .main-inner {
      max-width: 1100px;
      width: 100%;
    }

    section.view {
      display: none;
      min-height: calc(100vh - 150px);
      opacity: 0;
      transform: translateY(4px);
    }

    section.view.active {
      display: block;
      animation: fadeInView 0.2s ease-out forwards;
    }

    .panel {
      background: linear-gradient(145deg, var(--panel) 0%, var(--panel-soft) 100%);
      border-radius: 20px;
      border: 1px solid rgba(148, 27, 84, 0.6);
      box-shadow: var(--shadow);
      padding: 16px 16px 18px;
      margin-bottom: 16px;
      animation: floatUp 0.25s ease-out;
    }

    @media (min-width: 900px) {
      .panel {
        padding: 18px 20px 20px;
        margin-bottom: 20px;
      }
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .panel-header h2 {
      margin: 0;
      font-size: 15px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: #fee2e2;
    }

    .panel-header small {
      font-size: 11px;
      color: var(--muted);
    }

    .panel-body {
      font-size: 13px;
      color: var(--text);
    }

    h3 {
      margin: 8px 0 4px;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #fecaca;
    }

    p { margin: 4px 0; line-height: 1.6; }

    .muted { font-size: 12px; color: var(--muted); }

    .grid-two {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
      gap: 10px;
    }

    @media (max-width: 900px) {
      .grid-two { grid-template-columns: minmax(0, 1fr); }
    }

    ul.clean {
      list-style: none;
      padding-left: 0;
      margin: 4px 0 0;
      font-size: 13px;
    }

    ul.clean li {
      margin-bottom: 4px;
      display: flex;
      gap: 6px;
    }

    ul.clean li span.b {
      color: var(--accent);
      font-size: 12px;
      margin-top: 1px;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .chip {
      font-size: 11px;
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 27, 84, 0.7);
      background: rgba(17, 24, 39, 0.96);
      color: var(--muted);
    }

    /* search results */

    .search-results-panel {
      margin-bottom: 10px;
      display: none;
    }

    .search-results-panel.active {
      display: block;
      animation: floatUp 0.22s ease-out;
    }

    .search-results-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .search-results-header span {
      font-size: 12px;
      color: var(--muted);
    }

    .search-result-item {
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.96);
      padding: 8px 10px;
      font-size: 12px;
      margin-bottom: 6px;
      cursor: pointer;
      transition: transform var(--fast), box-shadow var(--fast), border var(--fast), background var(--fast);
    }

    .search-result-item:hover {
      transform: translateY(-1px);
      border-color: var(--accent);
      box-shadow: 0 0 12px rgba(148, 27, 84, 0.7);
      background: rgba(15, 23, 42, 1);
    }

    .search-result-meta {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    .today-pill {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 27, 84, 0.7);
      background: rgba(15, 23, 42, 0.97);
      font-size: 11px;
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 8px;
    }

    .today-pill-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.9);
    }

    button {
      border-radius: 999px;
      border: 1px solid rgba(148, 27, 84, 0.8);
      background: rgba(15, 23, 42, 0.97);
      color: var(--text);
      font-size: 13px;
      padding: 7px 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition:
        transform var(--fast),
        box-shadow var(--fast),
        border var(--fast),
        background var(--fast),
        opacity var(--fast);
    }

    button.small { padding: 4px 9px; font-size: 11px; }

    button.primary {
      border-color: rgba(248, 113, 113, 0.9);
      background: linear-gradient(135deg, #f97316, #ec4899);
    }

    button.soft {
      border-color: rgba(148, 27, 84, 0.7);
      background: rgba(17, 24, 39, 0.96);
    }

    button:hover {
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 0 12px rgba(148, 27, 84, 0.9);
      opacity: 0.96;
    }

    button:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: none;
      opacity: 0.9;
    }

    select,
    input[type="text"],
    textarea {
      background: rgba(15, 23, 42, 0.95);
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 7px 10px;
      font-size: 13px;
      outline: none;
      width: 100%;
      font-family: inherit;
      transition: border var(--fast), box-shadow var(--fast), background var(--fast), transform var(--fast);
    }

    textarea {
      min-height: 60px;
      resize: vertical;
    }

    select:focus,
    input[type="text"]:focus,
    textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(236, 72, 153, 0.9);
      background: #020013;
      transform: translateY(-1px);
    }

    /* TAB BAR */

    .tabbar {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      padding: 4px 10px calc(6px + env(safe-area-inset-bottom));
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.98) 0, rgba(15, 23, 42, 0.98) 40%, rgba(2, 6, 23, 0.98) 100%);
      border-top: 1px solid rgba(31, 41, 55, 0.9);
      backdrop-filter: blur(18px);
      z-index: 30;
    }

    .tabbar-inner {
      max-width: 500px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .tab-btn {
      flex: 1;
      border-radius: 999px;
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 10px;
      padding: 5px 4px 4px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      cursor: pointer;
      transition: background var(--fast), color var(--fast), transform var(--fast);
    }

    .tab-btn-icon {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: 1px solid transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      margin-bottom: 1px;
    }

    .tab-btn.active {
      color: var(--text);
      background: rgba(15, 23, 42, 0.85);
      transform: translateY(-1px);
    }

    .tab-btn.active .tab-btn-icon {
      border-color: var(--accent);
      box-shadow:
        0 0 10px rgba(236, 72, 153, 0.9),
        0 0 18px rgba(148, 27, 84, 0.8);
    }

    /* FLASHCARDS */

    .fc-top-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
    }

    .fc-top-row label {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      flex-direction: column;
      gap: 3px;
      min-width: 150px;
    }

    .quick-decks {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    .flashcard-shell { margin-top: 10px; }

    .progress-bar {
      height: 5px;
      border-radius: 999px;
      background: rgba(148, 27, 84, 0.45);
      overflow: hidden;
      margin-bottom: 8px;
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #ec4899, #f97316);
      transition: width 0.2s ease-out;
    }

    .flashcard-box {
      border-radius: 18px;
      border: 1px solid rgba(148, 27, 84, 0.85);
      background: radial-gradient(circle at top left, #11051f 0, #050012 70%);
      padding: 16px 14px 14px;
      min-height: 190px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      cursor: pointer;
      transition:
        border var(--fast),
        box-shadow var(--fast),
        transform var(--fast),
        background var(--fast);
    }

    .flashcard-box:hover {
      transform: translateY(-2px) scale(1.01);
      box-shadow: 0 0 18px rgba(148, 27, 84, 0.9);
      background: radial-gradient(circle at top left, #1a082f 0, #050012 70%);
    }

    .flashcard-box:active { transform: scale(0.99); }

    .flashcard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .flashcard-tag {
      padding: 3px 10px;
      border-radius: 999px;
      border: 1px solid rgba(248, 113, 113, 0.9);
      background: rgba(15, 23, 42, 0.96);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .tag-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow:
        0 0 10px rgba(236, 72, 153, 0.9),
        0 0 18px rgba(248, 113, 113, 0.9);
    }

    .flashcard-text {
      font-size: 15px;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .flashcard-text.empty {
      font-size: 13px;
      font-style: italic;
      color: var(--muted);
    }

    .flashcard-footer {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 10px;
      font-size: 11px;
      color: var(--muted);
    }

    .fc-controls {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
    }

    .fc-status {
      margin-top: 6px;
      font-size: 11px;
      color: var(--muted);
    }

    /* POEMS */

    .poem-list {
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 27, 84, 0.7);
      background: rgba(15, 23, 42, 0.8);
      padding: 6px 8px;
    }

    details.poem-details {
      border-radius: 12px;
      padding: 6px 8px;
      margin: 2px 0;
      transition: background var(--fast), border var(--fast), transform var(--fast);
    }

    details.poem-details[open] {
      background: rgba(15, 23, 42, 0.95);
      border-color: var(--accent);
      transform: translateY(-1px);
    }

    .poem-summary {
      list-style: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 13px;
    }

    .poem-title { font-weight: 600; }
    .poem-chevron { font-size: 11px; color: var(--muted); margin-left: 8px; }
    .poem-body { margin-top: 4px; font-size: 12px; }
    .poem-sub {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
      margin-top: 4px;
    }
    .poem-detail { margin: 2px 0; }

    /* TOOLS */

    .tool-card {
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.92);
      padding: 8px 9px;
      margin-top: 8px;
      animation: floatUp 0.25s ease-out;
    }

    .tool-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .tool-card-title {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .tool-card-body {
      margin-top: 6px;
      font-size: 12px;
    }

    .more-content {
      display: none;
      margin-top: 6px;
      animation: floatUp 0.22s ease-out;
    }

    .more-content.open { display: block; }

    .mini-label {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    .quote-result {
      border-radius: 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      padding: 6px 8px;
      margin-bottom: 6px;
      background: rgba(15, 23, 42, 0.9);
      font-size: 12px;
    }

    .quote-result-source {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    .builder-grid {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 6px;
    }

    .builder-output {
      margin-top: 6px;
      border-radius: 10px;
      border: 1px solid rgba(148, 27, 84, 0.7);
      padding: 8px 10px;
      background: rgba(15, 23, 42, 0.9);
      font-size: 13px;
      white-space: pre-wrap;
    }

    .question-output {
      margin-top: 6px;
      border-radius: 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      padding: 8px 10px;
      background: rgba(15, 23, 42, 0.9);
      font-size: 13px;
    }

    .sentence-chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .sentence-chip {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.95);
    }

    .formula-box {
      margin-top: 4px;
      border-radius: 10px;
      border: 1px solid rgba(148, 27, 84, 0.7);
      padding: 8px 10px;
      background: rgba(15, 23, 42, 0.9);
      font-size: 12px;
    }

    .formula-line { margin: 2px 0; }
    .formula-key { font-weight: 600; color: #fecaca; }

    .checklist-group details {
      border-radius: 12px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.9);
      padding: 6px 8px;
      margin-bottom: 6px;
      font-size: 12px;
      transition: border var(--fast), background var(--fast), transform var(--fast);
    }

    .checklist-group details[open] {
      border-color: var(--accent);
      transform: translateY(-1px);
    }

    .checklist-group summary {
      cursor: pointer;
      list-style: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .checklist-group ul {
      list-style: none;
      padding-left: 0;
      margin-top: 4px;
    }

    .checklist-group li {
      margin-bottom: 3px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .timer-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-top: 4px;
    }

    .timer-display {
      font-variant-numeric: tabular-nums;
      font-size: 18px;
    }

    @media (max-width: 480px) {
      .app-header-inner { padding-inline: 10px; }
      main { padding-inline: 10px; }
      .panel { padding-inline: 14px; }
    }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header class="app-header">
    <div class="app-header-inner">
      <div class="header-row-top">
        <div class="brand-block">
          <div class="brand-dot"></div>
          <div>
            <div class="brand-text-main">GCSE STUDY</div>
            <div class="brand-text-sub" id="mode-label">English revision</div>
          </div>
        </div>
        <div class="header-right">
          <div class="subject-toggle">
            <button class="subject-btn active" data-subject="english">English</button>
            <button class="subject-btn" data-subject="science">Science</button>
          </div>
          <div class="theme-select-wrap">
            <span>Theme</span>
            <select id="theme-select">
              <option value="neon">Neon Purple</option>
              <option value="ocean">Deep Ocean</option>
              <option value="sunset">Sunset Glow</option>
              <option value="mono">Clean Mono</option>
              <option value="matrix">Matrix Green</option>
              <option value="darkred">Dark Red</option>
              <option value="cats">Cat Mode</option>
            </select>
          </div>
        </div>
      </div>

      <div class="header-row-search">
        <div class="search-bar">
          <span>üîç</span>
          <input id="global-search-input" type="text" placeholder="Search ACC, Macbeth, AIC, poems, science topics..." />
        </div>
        <button id="global-search-btn" class="search-button">Search</button>
      </div>
    </div>
  </header>

  <main>
    <div class="main-inner">
      <!-- GLOBAL SEARCH RESULTS -->
      <div id="global-search-panel" class="search-results-panel">
        <div class="panel">
          <div class="search-results-header">
            <span id="search-title">Search results</span>
            <button id="search-clear" class="soft small">Clear</button>
          </div>
          <div id="search-results"></div>
        </div>
      </div>

      <!-- HOME -->
      <section id="view-home" class="view active">
        <span class="today-pill">
          <span class="today-pill-dot"></span>
          <span id="today-focus">Today: ACC extract + 10 flashcards.</span>
        </span>

        <div class="panel">
          <div class="panel-header">
            <div>
              <h2>Overview</h2>
              <small>English & Combined Science revision</small>
            </div>
          </div>
          <div class="panel-body">
            <div class="grid-two">
              <!-- ENGLISH OVERVIEW -->
              <div data-subject-section="english">
                <h3>English content</h3>
                <ul class="clean">
                  <li><span class="b">‚òÖ</span><span><strong>A Christmas Carol</strong> ‚Äì quotes, staves, themes, redemption (cards + search).</span></li>
                  <li><span class="b">‚òÖ</span><span><strong>Belonging Anthology</strong> ‚Äì core poems with meaning, language, context.</span></li>
                  <li><span class="b">‚òÖ</span><span><strong>Language Paper 1</strong> ‚Äì question structures, timings, story planning.</span></li>
                  <li><span class="b">‚òÖ</span><span><strong>Language Paper 2</strong> ‚Äì comparison, evaluation, transactional writing.</span></li>
                  <li><span class="b">‚òÖ</span><span><strong>Macbeth</strong> ‚Äì quotes, moments, themes, characters (deck + search).</span></li>
                  <li><span class="b">‚òÖ</span><span><strong>An Inspector Calls</strong> ‚Äì quotes, themes, characters, responsibility (deck + search).</span></li>
                </ul>
              </div>

              <!-- SCIENCE OVERVIEW -->
              <div data-subject-section="science">
                <h3>Science content</h3>
                <ul class="clean">
                  <li><span class="b">‚òÖ</span><span><strong>Biology</strong> ‚Äì cells, organisation, disease, health.</span></li>
                  <li><span class="b">‚òÖ</span><span><strong>Chemistry</strong> ‚Äì atoms, bonding, reactions, energy changes.</span></li>
                  <li><span class="b">‚òÖ</span><span><strong>Physics</strong> ‚Äì energy, electricity, forces, waves.</span></li>
                  <li><span class="b">‚òÖ</span><span><strong>Decks</strong> ‚Äì built for AQA Combined Science topics.</span></li>
                </ul>
                <div class="chip-row">
                  <span class="chip">Use the subject toggle for English / Science cards.</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="panel-header">
            <div>
              <h2>Start now</h2>
              <small>Quick shortcuts</small>
            </div>
          </div>
          <div class="panel-body">
            <div class="chip-row">
              <button class="soft small" data-action="focus-search">Search</button>
              <button class="soft small" data-goto="flashcards">Flashcards</button>
              <button class="soft small" data-goto="guides">Exam structures</button>
              <button class="soft small" data-goto="anthology">Belonging poems</button>
              <button class="soft small" data-goto="tools">Tools</button>
            </div>
            <p class="muted" style="margin-top:8px;">
              Try: ‚ÄúMacbeth ambition‚Äù, ‚ÄúAIC Eva Smith‚Äù, ‚ÄúACC redemption‚Äù, ‚Äúcells‚Äù, ‚Äúenergy stores‚Äù.
            </p>
          </div>
        </div>
      </section>

      <!-- GUIDES (ENGLISH ONLY) -->
      <section id="view-guides" class="view">
        <div class="panel">
          <div class="panel-header">
            <div>
              <h2>Language Paper 1</h2>
              <small>19th century extract + story writing</small>
            </div>
          </div>
          <div class="panel-body">
            <h3>Order & timings</h3>
            <ul class="clean">
              <li><span class="b">1</span><span><strong>Q5/6</strong> (story) ‚Äì 45 mins.</span></li>
              <li><span class="b">2</span><span><strong>Read extract</strong> ‚Äì 10 mins.</span></li>
              <li><span class="b">3</span><span><strong>Q1‚Äì4</strong>: Q1 2 mins, Q2 4 mins, Q3 10 mins, Q4 35 mins.</span></li>
            </ul>

            <h3>Q1‚Äì4 breakdown</h3>
            <ul class="clean">
              <li><span class="b">Q1</span><span>Comprehension ‚Äì 1 mark. One short answer from the text.</span></li>
              <li><span class="b">Q2</span><span>Inference ‚Äì 2 marks. 2 inferences with evidence.</span></li>
              <li><span class="b">Q3</span><span>Analysis ‚Äì 6 marks. Two paragraphs (language & structure). Point ‚Üí Evidence ‚Üí Technique ‚Üí Effect.</span></li>
              <li><span class="b">Q4</span><span>Evaluation ‚Äì 15 marks. Two paragraphs using SPITTED and evaluative language.</span></li>
            </ul>

            <h3>Q5/6 ‚Äì story structure</h3>
            <ul class="clean">
              <li><span class="b">DROP</span><span>Describe atmosphere with senses + figurative language.</span></li>
              <li><span class="b">ZOOM</span><span>Zoom into the character.</span></li>
              <li><span class="b">FLASHBACK</span><span>Explain how they got there.</span></li>
              <li><span class="b">ECHO</span><span>Return to present, echo or twist opening.</span></li>
            </ul>
          </div>
        </div>

        <div class="panel">
          <div class="panel-header">
            <div>
              <h2>Language Paper 2</h2>
              <small>Non-fiction + transactional writing</small>
            </div>
          </div>
          <div class="panel-body">
            <h3>Order & timings</h3>
            <ul class="clean">
              <li><span class="b">1</span><span><strong>Q8/9</strong> (transactional) ‚Äì 45 mins.</span></li>
              <li><span class="b">2</span><span>Read Extract 1 ‚Äì 10 mins ‚Üí Q1‚Äì3.</span></li>
              <li><span class="b">3</span><span>Read Extract 2 ‚Äì 10 mins ‚Üí Q4‚Äì7a/7b.</span></li>
            </ul>

            <h3>Key questions</h3>
            <ul class="clean">
              <li><span class="b">Q3</span><span>Analysis of Extract 1 ‚Äì 15 marks (language + structure).</span></li>
              <li><span class="b">Q6</span><span>Evaluation of Extract 2 ‚Äì 15 marks using SPITTED + intentions.</span></li>
              <li><span class="b">Q7a</span><span>Synthesis ‚Äì similarities between texts.</span></li>
              <li><span class="b">Q7b</span><span>Comparison ‚Äì ideas + methods + effects.</span></li>
            </ul>

            <h3>Q8/9 ‚Äì structure</h3>
            <ul class="clean">
              <li><span class="b">Statement</span><span>Clear view.</span></li>
              <li><span class="b">Counter</span><span>Other opinion + why it‚Äôs weaker.</span></li>
              <li><span class="b">Anecdote</span><span>Short story / example.</span></li>
              <li><span class="b">Reasons</span><span>Stats / experts.</span></li>
              <li><span class="b">Final plea</span><span>Imperatives to convince audience.</span></li>
            </ul>
          </div>
        </div>

        <div class="panel">
          <div class="panel-header">
            <div>
              <h2>Literature Papers</h2>
              <small>Macbeth ¬∑ An Inspector Calls ¬∑ ACC ¬∑ Poetry</small>
            </div>
          </div>
          <div class="panel-body">
            <h3>Literature Paper 1</h3>
            <ul class="clean">
              <li><span class="b">Macbeth A</span><span>Extract ‚Äì 20 marks ¬∑ 30 mins. No context; Point ‚Üí Quote ‚Üí Technique ‚Üí Effect.</span></li>
              <li><span class="b">Macbeth B</span><span>Essay ‚Äì 20 marks ¬∑ 30 mins. Add context + Shakespeare‚Äôs purpose.</span></li>
              <li><span class="b">AIC</span><span>Essay ‚Äì 40 marks ¬∑ 45 mins. Intro ¬∑ 3 paragraphs ¬∑ conclusion; Priestley presents‚Ä¶ ‚Üí Quote ‚Üí Explanation ‚Üí Context ‚Üí Purpose.</span></li>
            </ul>

            <h3>Literature Paper 2</h3>
            <ul class="clean">
              <li><span class="b">ACC A</span><span>Extract ‚Äì 20 marks ¬∑ 25 mins.</span></li>
              <li><span class="b">ACC B</span><span>Essay ‚Äì 20 marks ¬∑ 25 mins (Dickens‚Äô purpose).</span></li>
              <li><span class="b">Anthology</span><span>Comparison ‚Äì 20 marks ¬∑ 30 mins. Compare given poem with one you choose.</span></li>
              <li><span class="b">Unseen</span><span>Two poems ‚Äì 20 marks ¬∑ 45 mins. Compare ideas + methods + effects.</span></li>
            </ul>
          </div>
        </div>
      </section>

      <!-- FLASHCARDS -->
      <section id="view-flashcards" class="view">
        <div class="panel">
          <div class="panel-header">
            <div>
              <h2>Flashcards</h2>
              <small>Switch English / Science at the top</small>
            </div>
          </div>
          <div class="panel-body">
            <div class="fc-top-row">
              <label>
                <span>Deck</span>
                <select id="deck-select"></select>
              </label>
              <span id="deck-info" class="muted">0 cards</span>
            </div>

            <div id="quick-decks" class="quick-decks">
              <button class="soft small" data-quick-deck="ACC ‚Äì Key Quotes">ACC</button>
              <button class="soft small" data-quick-deck="Belonging ‚Äì Poems">Belonging</button>
              <button class="soft small" data-quick-deck="Language Paper 1 ‚Äì Structure">Lang P1</button>
              <button class="soft small" data-quick-deck="Language Paper 2 ‚Äì Structure">Lang P2</button>
              <button class="soft small" data-quick-deck="Literature Paper 1 ‚Äì Structure">Lit P1</button>
              <button class="soft small" data-quick-deck="Literature Paper 2 ‚Äì Structure">Lit P2</button>
              <button class="soft small" data-quick-deck="Macbeth ‚Äì Key Quotes & Ideas">Macbeth</button>
              <button class="soft small" data-quick-deck="AIC ‚Äì Key Quotes & Ideas">AIC</button>
            </div>

            <div class="flashcard-shell">
              <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
              </div>

              <div class="flashcard-box" id="study-card" title="Tap to flip">
                <div class="flashcard-header">
                  <div class="flashcard-tag">
                    <span class="tag-dot"></span>
                    <span id="card-side-label">Front ¬∑ Question</span>
                  </div>
                  <span id="card-meta" class="muted"></span>
                </div>
                <div class="flashcard-text empty" id="card-text">
                  No cards yet in this deck.
                </div>
                <div class="flashcard-footer">
                  <span><strong id="card-position">0 / 0</strong> ¬∑ deck: <span id="deck-name-label">‚Äî</span></span>
                  <span>Tap card to flip</span>
                </div>
              </div>

              <div class="fc-controls">
                <button id="fc-restart" class="primary small">‚ñ∂ Start</button>
                <button id="fc-prev" class="soft small">‚óÄ Prev</button>
                <button id="fc-next" class="soft small">Next ‚ñ∂</button>
                <button id="fc-flip" class="soft small">‚ü≤ Flip</button>
                <label style="display:flex;align-items:center;gap:4px;font-size:11px;color:var(--muted);">
                  <input type="checkbox" id="fc-shuffle" />
                  Shuffle
                </label>
              </div>

              <div class="fc-status" id="fc-status"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- ANTHOLOGY (ENGLISH ONLY) -->
      <section id="view-anthology" class="view">
        <div class="panel">
          <div class="panel-header">
            <div>
              <h2>Belonging Anthology</h2>
              <small>Tap a poem for notes</small>
            </div>
          </div>
          <div class="panel-body">
            <div class="poem-list">
              <details class="poem-details">
                <summary class="poem-summary">
                  <span class="poem-title">Island Man ‚Äì Grace Nichols</span>
                  <span class="poem-chevron">tap ‚ñæ</span>
                </summary>
                <div class="poem-body">
                  <div class="poem-sub">About</div>
                  <div class="poem-detail">A man wakes thinking he is in the Caribbean but is actually in London.</div>
                  <div class="poem-sub">Key quotation</div>
                  <div class="poem-detail">‚Äúhis small emerald island‚Äù ‚Äì metaphor makes the island precious and beautiful.</div>
                  <div class="poem-detail">‚Äúdull north circular roar‚Äù ‚Äì imagery makes London oppressive and overwhelming.</div>
                  <div class="poem-sub">Structure & form</div>
                  <div class="poem-detail">Free verse, no punctuation ‚Äì dreamy flow between sleep and waking.</div>
                  <div class="poem-sub">Context</div>
                  <div class="poem-detail">Nichols moved from the Caribbean to London.</div>
                  <div class="poem-sub">Themes</div>
                  <div class="poem-detail">Youth, nature, nostalgia, dual identity, London as home.</div>
                </div>
              </details>

              <details class="poem-details">
                <summary class="poem-summary">
                  <span class="poem-title">To My Sister ‚Äì William Wordsworth</span>
                  <span class="poem-chevron">tap ‚ñæ</span>
                </summary>
                <div class="poem-body">
                  <div class="poem-sub">About</div>
                  <div class="poem-detail">Speaker tells his sister to enjoy nature in spring.</div>
                  <div class="poem-sub">Key quotation</div>
                  <div class="poem-detail">‚ÄúOur minds shall drink at every pore the spirit of the season‚Äù ‚Äì personification; nature refreshes and empowers them.</div>
                  <div class="poem-sub">Structure & form</div>
                  <div class="poem-detail">ABAB rhyme, short stanzas ‚Äì enthusiastic tone.</div>
                  <div class="poem-sub">Context</div>
                  <div class="poem-detail">Wordsworth was a Romantic: nature, youth, freedom, emotion.</div>
                  <div class="poem-sub">Themes</div>
                  <div class="poem-detail">Nature, family, exploration of self.</div>
                </div>
              </details>

              <details class="poem-details">
                <summary class="poem-summary">
                  <span class="poem-title">Sunday Dip ‚Äì John Clare</span>
                  <span class="poem-chevron">tap ‚ñæ</span>
                </summary>
                <div class="poem-body">
                  <div class="poem-sub">About</div>
                  <div class="poem-detail">Boys enjoy their only day off by swimming in a river.</div>
                  <div class="poem-sub">Key quotation</div>
                  <div class="poem-detail">‚ÄúAnd Laugh to hear the thunder in their ears‚Äù ‚Äì metaphor; their noise is like thunder.</div>
                  <div class="poem-sub">Structure & form</div>
                  <div class="poem-detail">Repetition of ‚ÄúAnd‚Äù builds excitement and energy.</div>
                  <div class="poem-sub">Context</div>
                  <div class="poem-detail">Clare is a Romantic; simple form to be accessible.</div>
                  <div class="poem-sub">Themes</div>
                  <div class="poem-detail">Youth, nature, nostalgia, community.</div>
                </div>
              </details>

              <details class="poem-details">
                <summary class="poem-summary">
                  <span class="poem-title">I Remember, I Remember ‚Äì Thomas Hood</span>
                  <span class="poem-chevron">tap ‚ñæ</span>
                </summary>
                <div class="poem-body">
                  <div class="poem-sub">About</div>
                  <div class="poem-detail">A chronically ill man remembers childhood as joyful and perfect.</div>
                  <div class="poem-sub">Key quotation</div>
                  <div class="poem-detail">‚ÄúMy spirit flew in feathers then, / That is so heavy now‚Äù ‚Äì metaphor; free when young, weighed down now.</div>
                  <div class="poem-sub">Structure & form</div>
                  <div class="poem-detail">Repetition of ‚ÄúI remember, I remember‚Äù shows deep nostalgia.</div>
                  <div class="poem-sub">Context</div>
                  <div class="poem-detail">Hood was chronically ill.</div>
                  <div class="poem-sub">Themes</div>
                  <div class="poem-detail">Youth, nature, nostalgia, exploration of self.</div>
                </div>
              </details>

              <details class="poem-details">
                <summary class="poem-summary">
                  <span class="poem-title">We Refugees ‚Äì Benjamin Zephaniah</span>
                  <span class="poem-chevron">tap ‚ñæ</span>
                </summary>
                <div class="poem-body">
                  <div class="poem-sub">About</div>
                  <div class="poem-detail">Different refugees describe their experiences.</div>
                  <div class="poem-sub">Key quotation</div>
                  <div class="poem-detail">‚ÄúWe can all be refugees‚Äù ‚Äì collective pronoun; it could happen to anyone.</div>
                  <div class="poem-sub">Structure & form</div>
                  <div class="poem-detail">Stanzas starting with ‚ÄúI‚Äù give different voices.</div>
                  <div class="poem-sub">Context</div>
                  <div class="poem-detail">Zephaniah is an activist for refugees and human rights.</div>
                  <div class="poem-sub">Themes</div>
                  <div class="poem-detail">Nostalgia, family, dual identity, community.</div>
                </div>
              </details>

              <details class="poem-details">
                <summary class="poem-summary">
                  <span class="poem-title">Jamaican British ‚Äì James Berry</span>
                  <span class="poem-chevron">tap ‚ñæ</span>
                </summary>
                <div class="poem-body">
                  <div class="poem-sub">About</div>
                  <div class="poem-detail">Mixed-race speaker remembers bullying at school and later values his Jamaican heritage.</div>
                  <div class="poem-sub">Key quotation</div>
                  <div class="poem-detail">‚Äúthe English boys at school made me choose Jamaican, British?‚Äù ‚Äì question + caesura show pressure and identity conflict.</div>
                  <div class="poem-sub">Structure & form</div>
                  <div class="poem-detail">Repetition of ‚ÄúJamaican British‚Äù shows focus on identity.</div>
                  <div class="poem-sub">Context</div>
                  <div class="poem-detail">Autobiographical ‚Äì based on Berry‚Äôs experience.</div>
                  <div class="poem-sub">Themes</div>
                  <div class="poem-detail">Youth, family, dual identity, London as home, community, exploration of self.</div>
                </div>
              </details>
            </div>
          </div>
        </div>
      </section>

      <!-- TOOLS -->
      <section id="view-tools" class="view">
        <div class="panel">
          <div class="panel-header">
            <div>
              <h2>Tools</h2>
              <small>Quote search ¬∑ builder ¬∑ timer ¬∑ checklists</small>
            </div>
          </div>
          <div class="panel-body">
            <!-- QUOTE FINDER -->
            <div class="tool-card">
              <div class="tool-card-header">
                <div class="tool-card-title">Quote / fact finder</div>
                <button class="soft small" data-toggle="#tool-quote" data-closed="Open" data-open="Close">Open</button>
              </div>
              <div class="tool-card-body more-content" id="tool-quote">
                <div class="grid-two">
                  <div>
                    <label class="mini-label">Search term</label>
                    <input id="quote-search-input" type="text" placeholder="e.g. 'Macbeth guilt', 'Eva Smith', 'cells', 'energy'..." />
                  </div>
                  <div>
                    <label class="mini-label">Scope</label>
                    <select id="quote-scope">
                      <option value="all">All</option>
                      <option value="ACC">ACC</option>
                      <option value="Belonging">Belonging</option>
                      <option value="Language">Language</option>
                      <option value="Literature">Literature</option>
                      <option value="Science">Science</option>
                    </select>
                  </div>
                </div>
                <div style="margin-top:6px;display:flex;gap:6px;flex-wrap:wrap;">
                  <button class="soft small" id="quote-search-btn">Search</button>
                  <button class="soft small" id="quote-clear-btn">Clear</button>
                </div>
                <div id="quote-results" style="margin-top:6px;"></div>
              </div>
            </div>

            <!-- PARAGRAPH BUILDER -->
            <div class="tool-card">
              <div class="tool-card-header">
                <div class="tool-card-title">Paragraph builder</div>
                <button class="soft small" data-toggle="#tool-builder" data-closed="Open" data-open="Close">Open</button>
              </div>
              <div class="tool-card-body more-content" id="tool-builder">
                <div class="builder-grid">
                  <label>
                    <span class="mini-label">Type</span>
                    <select id="builder-type">
                      <option value="lang">Language analysis</option>
                      <option value="lit">Literature essay</option>
                      <option value="poetry">Poetry comparison</option>
                      <option value="tx">Transactional writing</option>
                    </select>
                  </label>
                  <label>
                    <span class="mini-label">Point</span>
                    <textarea id="builder-point" placeholder="e.g. The writer presents Scrooge as stubborn and cruel..."></textarea>
                  </label>
                  <label>
                    <span class="mini-label">Evidence</span>
                    <textarea id="builder-evidence" placeholder="Short quotation."></textarea>
                  </label>
                  <label>
                    <span class="mini-label">Technique</span>
                    <textarea id="builder-technique" placeholder="metaphor, simile, rhetorical question..."></textarea>
                  </label>
                  <label>
                    <span class="mini-label">Effect</span>
                    <textarea id="builder-effect" placeholder="What the reader thinks/feels."></textarea>
                  </label>
                  <label>
                    <span class="mini-label">Context / purpose (if needed)</span>
                    <textarea id="builder-context" placeholder="Context or writer‚Äôs aim."></textarea>
                  </label>
                </div>
                <div style="margin-top:6px;display:flex;gap:6px;flex-wrap:wrap;">
                  <button class="primary small" id="builder-generate">Build paragraph</button>
                  <button class="soft small" id="builder-clear">Clear</button>
                </div>
                <div id="builder-output" class="builder-output"></div>
              </div>
            </div>

            <!-- RANDOM QUESTIONS -->
            <div class="tool-card">
              <div class="tool-card-header">
                <div class="tool-card-title">Random questions</div>
                <button class="soft small" data-toggle="#tool-questions" data-closed="Open" data-open="Close">Open</button>
              </div>
              <div class="tool-card-body more-content" id="tool-questions">
                <div class="mini-label">Tap for a practice question:</div>
                <div style="margin-top:4px;display:flex;flex-wrap:wrap;gap:6px;">
                  <button class="soft small" data-qset="lang-p1">Lang P1</button>
                  <button class="soft small" data-qset="lang-p2">Lang P2</button>
                  <button class="soft small" data-qset="acc">ACC</button>
                  <button class="soft small" data-qset="macbeth">Macbeth</button>
                  <button class="soft small" data-qset="aic">AIC</button>
                  <button class="soft small" data-qset="belonging">Belonging</button>
                  <button class="soft small" data-qset="unseen">Unseen</button>
                  <button class="soft small" data-qset="science">Science</button>
                </div>
                <div id="question-output" class="question-output"></div>
              </div>
            </div>

            <!-- SENTENCE OPENERS -->
            <div class="tool-card">
              <div class="tool-card-header">
                <div class="tool-card-title">Sentence openers</div>
                <button class="soft small" data-toggle="#tool-openers" data-closed="Open" data-open="Close">Open</button>
              </div>
              <div class="tool-card-body more-content" id="tool-openers">
                <div class="mini-label">Tap any opener and copy:</div>
                <div class="sentence-chip-row">
                  <div class="sentence-chip">Reluctantly, I realised that...</div>
                  <div class="sentence-chip">For a brief moment,...</div>
                  <div class="sentence-chip">Without warning,...</div>
                  <div class="sentence-chip">From the shadows,...</div>
                  <div class="sentence-chip">In the distance, I could see...</div>
                  <div class="sentence-chip">Surprisingly, it seemed that...</div>
                  <div class="sentence-chip">On the other hand, some may argue that...</div>
                  <div class="sentence-chip">It is impossible to ignore that...</div>
                </div>
              </div>
            </div>

            <!-- STRUCTURES -->
            <div class="tool-card">
              <div class="tool-card-header">
                <div class="tool-card-title">Structures & acronyms</div>
                <button class="soft small" data-toggle="#tool-structures" data-closed="Open" data-open="Close">Open</button>
              </div>
              <div class="tool-card-body more-content" id="tool-structures">
                <div class="formula-box">
                  <div class="formula-line"><span class="formula-key">SPITTED</span> ‚Äì Setting, People, Ideas, Tone, Theme, Events, Description.</div>
                  <div class="formula-line"><span class="formula-key">DAFOREST</span> ‚Äì Direct address, Alliteration, Fact, Opinion, Rhetorical questions, Emotive language, Statistics, Tripling.</div>
                  <div class="formula-line"><span class="formula-key">Paragraph</span> ‚Äì Point ‚Üí Evidence ‚Üí Technique ‚Üí Effect ‚Üí Context/Purpose.</div>
                  <div class="formula-line"><span class="formula-key">Story</span> ‚Äì DROP ‚Üí ZOOM ‚Üí FLASHBACK ‚Üí ECHO.</div>
                </div>
              </div>
            </div>

            <!-- CHECKLISTS + TIMER -->
            <div class="tool-card">
              <div class="tool-card-header">
                <div class="tool-card-title">Checklists & timer</div>
                <button class="soft small" data-toggle="#tool-checklists" data-closed="Open" data-open="Close">Open</button>
              </div>
              <div class="tool-card-body more-content" id="tool-checklists">
                <div class="checklist-group">
                  <details>
                    <summary><span>Lang Paper 1 ‚Äì Q5 imaginative</span><span class="poem-chevron">tap ‚ñæ</span></summary>
                    <ul>
                      <li><input type="checkbox" /> DROP atmosphere at start.</li>
                      <li><input type="checkbox" /> ZOOM on character feelings.</li>
                      <li><input type="checkbox" /> FLASHBACK explains situation.</li>
                      <li><input type="checkbox" /> ECHO at end (cyclical feel).</li>
                      <li><input type="checkbox" /> Range of punctuation + sentences.</li>
                      <li><input type="checkbox" /> At least 3‚Äì4 strong techniques.</li>
                    </ul>
                  </details>

                  <details>
                    <summary><span>Lang Paper 2 ‚Äì Q8/9 transactional</span><span class="poem-chevron">tap ‚ñæ</span></summary>
                    <ul>
                      <li><input type="checkbox" /> Clear viewpoint statement.</li>
                      <li><input type="checkbox" /> Counter argument handled.</li>
                      <li><input type="checkbox" /> Anecdote/example included.</li>
                      <li><input type="checkbox" /> Reasons with stats/experts.</li>
                      <li><input type="checkbox" /> DAFOREST used several times.</li>
                    </ul>
                  </details>

                  <details>
                    <summary><span>Lit ‚Äì ACC / Macbeth / AIC essays</span><span class="poem-chevron">tap ‚ñæ</span></summary>
                    <ul>
                      <li><input type="checkbox" /> Every paragraph starts with a clear point.</li>
                      <li><input type="checkbox" /> Short, relevant quotations.</li>
                      <li><input type="checkbox" /> Techniques + effects explained.</li>
                      <li><input type="checkbox" /> Context/purpose used where needed.</li>
                      <li><input type="checkbox" /> Intro + conclusion answer the question.</li>
                    </ul>
                  </details>
                </div>

                <div style="margin-top:8px;">
                  <div class="mini-label">Focus timer (25 minutes)</div>
                  <div class="timer-row">
                    <div class="timer-display" id="timer-display">25:00</div>
                    <div style="display:flex;gap:6px;">
                      <button class="soft small" id="timer-start">Start</button>
                      <button class="soft small" id="timer-reset">Reset</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- TAB BAR -->
  <footer class="tabbar">
    <div class="tabbar-inner">
      <button class="tab-btn active" data-tab="home" data-scope="both">
        <div class="tab-btn-icon">üè†</div>
        <div>Home</div>
      </button>
      <button class="tab-btn" data-tab="guides" data-scope="english">
        <div class="tab-btn-icon">üìò</div>
        <div>Guides</div>
      </button>
      <button class="tab-btn" data-tab="flashcards" data-scope="both">
        <div class="tab-btn-icon">üÉè</div>
        <div>Cards</div>
      </button>
      <button class="tab-btn" data-tab="anthology" data-scope="english">
        <div class="tab-btn-icon">üìö</div>
        <div>Anthology</div>
      </button>
      <button class="tab-btn" data-tab="tools" data-scope="both">
        <div class="tab-btn-icon">üõ†</div>
        <div>Tools</div>
      </button>
    </div>
  </footer>

  <script>
    // ---------- THEMES ----------
    const THEMES = {
      neon: {
        bodyBg: "radial-gradient(circle at top, #160322 0, #05010b 45%, #020009 100%)",
        "--panel": "#090317",
        "--panel-soft": "#0b041b",
        "--border": "#26163b",
        "--accent": "#ec4899",
        "--accent-soft": "rgba(236,72,153,0.16)",
        "--accent-strong": "#f97316",
        "--text": "#f9fafb",
        "--muted": "#9ca3af"
      },
      ocean: {
        bodyBg: "radial-gradient(circle at top, #022c3a 0, #020617 45%, #000814 100%)",
        "--panel": "#020617",
        "--panel-soft": "#02081f",
        "--border": "#0f172a",
        "--accent": "#38bdf8",
        "--accent-soft": "rgba(56,189,248,0.16)",
        "--accent-strong": "#06b6d4",
        "--text": "#f9fafb",
        "--muted": "#94a3b8"
      },
      sunset: {
        bodyBg: "radial-gradient(circle at top, #4c0519 0, #111827 45%, #020617 100%)",
        "--panel": "#111827",
        "--panel-soft": "#020617",
        "--border": "#7f1d1d",
        "--accent": "#f97316",
        "--accent-soft": "rgba(249,115,22,0.16)",
        "--accent-strong": "#ec4899",
        "--text": "#fefce8",
        "--muted": "#d1d5db"
      },
      mono: {
        bodyBg: "radial-gradient(circle at top, #020617 0, #020617 45%, #000000 100%)",
        "--panel": "#020617",
        "--panel-soft": "#020617",
        "--border": "#374151",
        "--accent": "#e5e7eb",
        "--accent-soft": "rgba(229,231,235,0.12)",
        "--accent-strong": "#facc15",
        "--text": "#f9fafb",
        "--muted": "#9ca3af"
      },
      matrix: {
        bodyBg: "radial-gradient(circle at top, #022c22 0, #020617 45%, #000000 100%)",
        "--panel": "#020617",
        "--panel-soft": "#00110f",
        "--border": "#047857",
        "--accent": "#22c55e",
        "--accent-soft": "rgba(34,197,94,0.16)",
        "--accent-strong": "#a3e635",
        "--text": "#e5f9f0",
        "--muted": "#6ee7b7"
      },
      darkred: {
        bodyBg: "radial-gradient(circle at top, #3b0a0a 0, #111827 45%, #020202 100%)",
        "--panel": "#111827",
        "--panel-soft": "#090314",
        "--border": "#7f1d1d",
        "--accent": "#ef4444",
        "--accent-soft": "rgba(239,68,68,0.16)",
        "--accent-strong": "#b91c1c",
        "--text": "#fee2e2",
        "--muted": "#fca5a5"
      },
      cats: {
        bodyBg: "radial-gradient(circle at top, #2b1b0e 0, #0f172a 45%, #020617 100%)",
        "--panel": "#0f172a",
        "--panel-soft": "#020617",
        "--border": "#92400e",
        "--accent": "#fbbf24",
        "--accent-soft": "rgba(251,191,36,0.16)",
        "--accent-strong": "#f97316",
        "--text": "#fffbeb",
        "--muted": "#facc15"
      }
    };

    const themeSelect = document.getElementById("theme-select");

    function applyTheme(key) {
      const t = THEMES[key] || THEMES.neon;
      document.body.style.background = t.bodyBg;
      Object.keys(t).forEach(k => {
        if (k.startsWith("--")) {
          document.documentElement.style.setProperty(k, t[k]);
        }
      });
      try { localStorage.setItem("revTheme", key); } catch (e) {}
    }

    (function initTheme() {
      let saved = null;
      try { saved = localStorage.getItem("revTheme"); } catch (e) {}
      if (!saved || !THEMES[saved]) saved = "neon";
      themeSelect.value = saved;
      applyTheme(saved);
    })();

    themeSelect.addEventListener("change", () => {
      applyTheme(themeSelect.value);
    });

    // ---------- TODAY FOCUS ----------
    const todayText = document.getElementById("today-focus");
    const focusOptions = [
      "Today: ACC extract + 10 English cards.",
      "Today: 1 Lang Paper 1 plan + 10 cards.",
      "Today: Belonging comparison + 10 cards.",
      "Today: Macbeth quote drill + AIC paragraph.",
      "Today: Science ‚Äì energy + cells cards."
    ];
    todayText.textContent =
      focusOptions[Math.floor(Math.random() * focusOptions.length)];

    // ---------- VIEWS / TABS ----------
    const views = {
      home: document.getElementById("view-home"),
      guides: document.getElementById("view-guides"),
      flashcards: document.getElementById("view-flashcards"),
      anthology: document.getElementById("view-anthology"),
      tools: document.getElementById("view-tools")
    };

    let currentView = "home";

    const tabButtons = Array.from(document.querySelectorAll(".tab-btn"));

    function setView(name) {
      currentView = name;
      Object.values(views).forEach(v => v.classList.remove("active"));
      if (views[name]) views[name].classList.add("active");

      tabButtons.forEach(btn => {
        btn.classList.toggle("active", btn.getAttribute("data-tab") === name);
      });

      window.scrollTo({ top: 0, behavior: "instant" });
    }

    tabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const target = btn.getAttribute("data-tab");
        setView(target);
      });
    });

    document.querySelectorAll("[data-goto]").forEach(btn => {
      btn.addEventListener("click", () => {
        const v = btn.getAttribute("data-goto");
        setView(v);
      });
    });

    const globalSearchInput = document.getElementById("global-search-input");
    document.querySelectorAll('[data-action="focus-search"]').forEach(btn => {
      btn.addEventListener("click", () => {
        setView("home");
        window.scrollTo({ top: 0, behavior: "smooth" });
        globalSearchInput.focus();
      });
    });

    // ---------- SUBJECT TOGGLE ----------
    let currentSubject = "english";
    const subjectButtons = document.querySelectorAll(".subject-btn");
    const modeLabel = document.getElementById("mode-label");
    const quickDecksEl = document.getElementById("quick-decks");

    function updateSubjectSections() {
      document.querySelectorAll("[data-subject-section]").forEach(el => {
        const s = el.getAttribute("data-subject-section");
        if (s === currentSubject) {
          el.style.display = "";
        } else {
          el.style.display = "none";
        }
      });
    }

    function setSubject(subj) {
      if (subj === currentSubject) return;
      currentSubject = subj;
      subjectButtons.forEach(btn => {
        btn.classList.toggle("active", btn.getAttribute("data-subject") === subj);
      });
      modeLabel.textContent =
        subj === "english" ? "English revision" : "Science revision";

      // Show/hide English-specific nav (Guides, Anthology)
      tabButtons.forEach(btn => {
        const scope = btn.getAttribute("data-scope") || "both";
        if (subj === "science" && scope === "english") {
          btn.style.display = "none";
        } else {
          btn.style.display = "flex";
        }
      });

      // If we are on an English-only view when switching to science, jump to flashcards
      if (subj === "science" && (currentView === "guides" || currentView === "anthology")) {
        setView("flashcards");
      }

      // Home overview columns
      updateSubjectSections();

      // Flashcard UI tweaks
      if (subj === "english") {
        quickDecksEl.style.display = "flex";
      } else {
        quickDecksEl.style.display = "none";
      }

      const decks = getActiveDecks();
      currentDeckName = Object.keys(decks)[0] || null;
      renderDeckOptions();
      resetStudyOrder();
    }

    subjectButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const subj = btn.getAttribute("data-subject");
        setSubject(subj);
      });
    });

    // ---------- DECKS (ENGLISH) ----------
    const DECKS_EN = {
      "ACC ‚Äì Key Quotes": [
        { front: "\"Marley was dead: to begin with.\"", back: "Opening line. Confirms Marley is dead and sets up the ghost story (Stave 1)." },
        { front: "\"As solitary as an oyster.\"", back: "Narrator describing Scrooge ‚Äì isolated, but with potential for change." },
        { front: "\"Bah! Humbug!\"", back: "Scrooge rejecting Christmas in Stave 1 ‚Äì shows cynicism and lack of empathy." },
        { front: "\"If they would rather die, they had better do it, and decrease the surplus population.\"", back: "Scrooge talking about the poor ‚Äì cruel attitude Dickens criticises." },
        { front: "\"Mankind was my business!\"", back: "Marley's Ghost ‚Äì regrets focusing on money instead of people." },
        { front: "\"A solitary child, neglected by his friends.\"", back: "Young Scrooge ‚Äì lonely upbringing explains later coldness." },
        { front: "\"Another idol has displaced me... a golden one.\"", back: "Belle ‚Äì money has replaced love in Scrooge's life." },
        { front: "\"A jolly Giant, glorious to see.\"", back: "Ghost of Christmas Present ‚Äì symbol of warmth and generosity." },
        { front: "\"God bless us, every one!\"", back: "Tiny Tim ‚Äì innocent blessing; moral centre of the novella." },
        { front: "\"This boy is Ignorance. This girl is Want.\"", back: "Personification of social problems caused by neglecting the poor." },
        { front: "\"I am not the man I was.\"", back: "Scrooge in Stave 4 ‚Äì clear moment of change." },
        { front: "\"I will honour Christmas in my heart, and try to keep it all the year.\"", back: "Scrooge ‚Äì promises lasting change." },
        { front: "\"He became as good a friend, as good a master, and as good a man.\"", back: "Narrator ‚Äì confirms Scrooge‚Äôs full redemption." }
      ],

      "Belonging ‚Äì Poems": [
        { front: "Island Man ‚Äì about?", back: "Man wakes thinking he is back in the Caribbean but is actually in London; split identity and homesickness." },
        { front: "Island Man ‚Äì key quotes", back: "\"his small emerald island\" vs \"dull north circular roar\" ‚Äì contrast between beautiful home and noisy city." },
        { front: "To My Sister ‚Äì about?", back: "Speaker tells his sister to enjoy nature in spring; power of nature and family bond." },
        { front: "Sunday Dip ‚Äì about?", back: "Boys enjoy their only day off by swimming in a river; joy and community." },
        { front: "I Remember ‚Äì key quote", back: "\"My spirit flew in feathers then, / That is so heavy now\" ‚Äì metaphor for freedom vs burden." },
        { front: "We Refugees ‚Äì key idea", back: "\"We can all be refugees\" ‚Äì it could happen to anyone; builds empathy." },
        { front: "Jamaican British ‚Äì key quote", back: "\"the English boys at school made me choose Jamaican, British?\" ‚Äì question + caesura show pressure and identity conflict." }
      ],

      "Language Paper 1 ‚Äì Structure": [
        { front: "Lang Paper 1 ‚Äì order", back: "1) Q5/6 (writing) ‚Äì 45 mins.\n2) Read extract ‚Äì 10 mins.\n3) Q1‚Äì4 with timings." },
        { front: "Lang P1 ‚Äì Q1 & Q2", back: "Q1: 1 mark, comprehension.\nQ2: 2 marks, inference using 2 quotes." },
        { front: "Lang P1 ‚Äì Q3", back: "6 marks ‚Äì 2 paragraphs (language + structure). Point ‚Üí Evidence ‚Üí Technique ‚Üí Effect." },
        { front: "Lang P1 ‚Äì Q4", back: "15 marks ‚Äì evaluation using SPITTED and evaluative language." },
        { front: "Lang P1 ‚Äì Q5/6 plan", back: "DROP ‚Üí ZOOM ‚Üí FLASHBACK ‚Üí ECHO story pattern." }
      ],

      "Language Paper 2 ‚Äì Structure": [
        { front: "Lang Paper 2 ‚Äì order", back: "1) Q8/9 transactional ‚Äì 45 mins.\n2) Extract 1 ‚Üí Q1‚Äì3.\n3) Extract 2 ‚Üí Q4‚Äì7a/7b." },
        { front: "Lang P2 ‚Äì Q3", back: "15 marks ‚Äì analysis of Extract 1 (language + structure)." },
        { front: "Lang P2 ‚Äì Q6", back: "15 marks ‚Äì evaluation of Extract 2 using SPITTED and intentions." },
        { front: "Lang P2 ‚Äì Q7a & Q7b", back: "Q7a: synthesis similarities.\nQ7b: comparison of ideas + methods." },
        { front: "Lang P2 ‚Äì Q8/9", back: "Statement ‚Üí Counter ‚Üí Anecdote ‚Üí Reasons ‚Üí Final plea. Use DAFOREST." }
      ],

      "Literature Paper 1 ‚Äì Structure": [
        { front: "Lit Paper 1 overview", back: "Macbeth A 20m, Macbeth B 20m, AIC 40m. Total 1h45." },
        { front: "Macbeth Part A", back: "Extract only; paragraphs: Point ‚Üí Quote ‚Üí Technique ‚Üí Effect." },
        { front: "Macbeth Part B", back: "Whole play; add context + Shakespeare‚Äôs purpose." },
        { front: "AIC essay", back: "Intro ¬∑ 3 paragraphs ¬∑ conclusion; Priestley presents‚Ä¶ ‚Üí Quote ‚Üí Explanation ‚Üí Context ‚Üí Purpose." }
      ],

      "Literature Paper 2 ‚Äì Structure": [
        { front: "Lit Paper 2 overview", back: "ACC extract 20m; ACC essay 20m; Anthology 20m; Unseen 20m. Total 2h15." },
        { front: "ACC Part A", back: "Extract only; paragraphs: Point ‚Üí Quote ‚Üí Technique ‚Üí Effect." },
        { front: "ACC Part B", back: "Whole novella; Dickens‚Äô purpose instead of context." },
        { front: "Anthology comparison", back: "Comparative point ‚Üí quotes + techniques + effect + intentions for both poems." },
        { front: "Unseen comparison", back: "Compare two unseen poems via ideas + methods + effects." }
      ],

      "Macbeth ‚Äì Key Quotes & Ideas": [
        { front: "\"Fair is foul, and foul is fair.\"", back: "Witches in Act 1. Theme of appearance vs reality and moral confusion." },
        { front: "\"Brave Macbeth ‚Äì well he deserves that name.\"", back: "Macbeth at the start ‚Äì loyal, heroic soldier." },
        { front: "\"Let not light see my black and deep desires.\"", back: "Macbeth hides his ambition to kill Duncan. Light vs dark imagery links ambition with evil." },
        { front: "\"Unsex me here.\"", back: "Lady Macbeth rejects stereotypical femininity to gain power and cruelty." },
        { front: "\"Look like th' innocent flower, but be the serpent under't.\"", back: "Lady Macbeth tells Macbeth to hide his true intentions. Appearance vs reality; serpent image." },
        { front: "\"Is this a dagger which I see before me?\"", back: "Macbeth hallucinates before killing Duncan. Symbol of guilt and his unstable mind." },
        { front: "\"Will all great Neptune's ocean wash this blood clean from my hand?\"", back: "Hyperbole ‚Äì guilt so huge it cannot be washed away. Blood symbolises guilt." },
        { front: "\"O full of scorpions is my mind, dear wife!\"", back: "Macbeth‚Äôs mind is poisoned with fear and paranoia." },
        { front: "\"Out, damned spot!\"", back: "Lady Macbeth imagines blood on her hands. Her earlier confidence collapses into guilt and madness." },
        { front: "\"Life's but a walking shadow... a tale told by an idiot.\"", back: "Macbeth‚Äôs nihilism after Lady Macbeth‚Äôs death; life feels meaningless." },
        { front: "Macbeth ‚Äì key moments", back: "Witches‚Äô prophecies; Duncan‚Äôs murder; Banquo‚Äôs murder and ghost; second visit to witches; Macduff‚Äôs family killed; Lady Macbeth‚Äôs sleepwalking; final battle." },
        { front: "Macbeth ‚Äì main themes", back: "Ambition; guilt; fate vs free will; appearance vs reality; masculinity and power; kingship and natural order." }
      ],

      "AIC ‚Äì Key Quotes & Ideas": [
        { front: "\"Unsinkable, absolutely unsinkable.\"", back: "Mr Birling about the Titanic. Dramatic irony; shows arrogance and ignorance." },
        { front: "\"A man has to make his own way.\"", back: "Birling‚Äôs capitalist view ‚Äì everyone looks after themselves only." },
        { front: "\"Girls of that class.\"", back: "Mrs Birling ‚Äì class prejudice and lack of empathy for working-class women." },
        { front: "\"But these girls aren't cheap labour ‚Äì they're people.\"", back: "Sheila begins to reject her parents‚Äô attitudes; shows moral development." },
        { front: "\"We are members of one body. We are responsible for each other.\"", back: "Inspector‚Äôs core message ‚Äì socialist idea of collective responsibility." },
        { front: "\"Each of you helped to kill her.\"", back: "Inspector sums up how all of them are linked to Eva‚Äôs death." },
        { front: "\"You lot may be letting yourselves out nicely, but I can't.\"", back: "Eric accepts guilt while his parents try to escape blame." },
        { front: "\"The famous younger generation who know it all.\"", back: "Birling mocks Sheila and Eric ‚Äì but audience sees younger generation learn more." },
        { front: "AIC ‚Äì key themes", back: "Social responsibility; class and inequality; gender; generation gap; guilt and denial." }
      ]
    };

    const DECK_SOURCE_EN = {
      "ACC ‚Äì Key Quotes": "ACC",
      "Belonging ‚Äì Poems": "Belonging",
      "Language Paper 1 ‚Äì Structure": "Language",
      "Language Paper 2 ‚Äì Structure": "Language",
      "Literature Paper 1 ‚Äì Structure": "Literature",
      "Literature Paper 2 ‚Äì Structure": "Literature",
      "Macbeth ‚Äì Key Quotes & Ideas": "Literature",
      "AIC ‚Äì Key Quotes & Ideas": "Literature"
    };

    // ---------- DECKS (SCIENCE ‚Äì AQA COMBINED SCIENCE STYLE) ----------
    const DECKS_SCI = {
      "Sci ‚Äì Biology: Cells & Organisation": [
        { front: "Cell", back: "Basic unit of life. Similar cells form tissues, tissues form organs, organs form organ systems, which make an organism." },
        { front: "Eukaryotic vs prokaryotic", back: "Eukaryotic cells (animal/plant) have a nucleus with DNA. Prokaryotic cells (bacteria) have no true nucleus; DNA is free in cytoplasm." },
        { front: "Animal cell structures", back: "Cell membrane, cytoplasm, nucleus, mitochondria, ribosomes." },
        { front: "Plant cell extra structures", back: "Chloroplasts (photosynthesis), permanent vacuole (cell sap), cell wall (support). Also have membrane, cytoplasm, nucleus." },
        { front: "Diffusion", back: "Net movement of particles from an area of higher concentration to an area of lower concentration (down a concentration gradient)." },
        { front: "Osmosis", back: "Diffusion of water through a partially permeable membrane from a dilute solution to a more concentrated solution." },
        { front: "Active transport", back: "Movement of particles from low to high concentration using energy from respiration." },
        { front: "Mitosis", back: "Cell division that produces two genetically identical daughter cells for growth and repair." },
        { front: "Stem cells", back: "Undifferentiated cells that can divide and become specialised cells. Found in embryos and some adult tissues." }
      ],

      "Sci ‚Äì Biology: Health & Disease": [
        { front: "Pathogen", back: "Microorganism that causes infectious disease (bacteria, viruses, fungi, protists)." },
        { front: "Immune system basics", back: "White blood cells ingest pathogens, produce antibodies (specific to antigens) and antitoxins." },
        { front: "Vaccination", back: "Dead or weakened pathogen injected; body makes memory cells so antibodies can be produced quickly if infected later." },
        { front: "Antibiotics", back: "Drugs that kill bacteria (not viruses). Overuse can lead to resistant strains." },
        { front: "Non-communicable disease", back: "Not spread from person to person (e.g. cancer, heart disease). Linked to risk factors such as diet, smoking, alcohol." }
      ],

      "Sci ‚Äì Chemistry: Atoms & Bonding": [
        { front: "Structure of atom", back: "Nucleus with protons (+1) and neutrons (0). Electrons (‚Äì1) in shells around nucleus." },
        { front: "Atomic number & mass number", back: "Atomic number = protons. Mass number = protons + neutrons." },
        { front: "Isotopes", back: "Atoms of the same element with the same number of protons but different numbers of neutrons." },
        { front: "Group 1 metals", back: "Alkali metals ‚Äì very reactive, soft, react with water to make hydrogen + alkali solution." },
        { front: "Group 7 halogens", back: "Non-metals; reactivity decreases down the group. Form salts with metals." },
        { front: "Ionic bonding", back: "Transfer of electrons from metal to non-metal. Oppositely charged ions attract strongly." },
        { front: "Covalent bonding", back: "Sharing pairs of electrons between non-metal atoms." },
        { front: "Metallic bonding", back: "Positive metal ions in a lattice with delocalised electrons ‚Äì strong attractions, conduct electricity." }
      ],

      "Sci ‚Äì Chemistry: Reactions & Energy": [
        { front: "Conservation of mass", back: "No atoms are created or destroyed in a chemical reaction; total mass of reactants equals products." },
        { front: "pH scale", back: "0‚Äì6 acidic, 7 neutral, 8‚Äì14 alkaline. Universal indicator shows colour changes." },
        { front: "Acid + metal", back: "Acid + metal ‚Üí salt + hydrogen (e.g. HCl + magnesium ‚Üí magnesium chloride + hydrogen)." },
        { front: "Exothermic reaction", back: "Transfers energy to surroundings (temperature rises). E.g. combustion, many oxidations." },
        { front: "Endothermic reaction", back: "Takes in energy from surroundings (temperature falls). E.g. thermal decomposition, some sports pack reactions." },
        { front: "Electrolysis basics", back: "Decomposition of an ionic compound using electricity. Positive ions move to the negative electrode (cathode)." }
      ],

      "Sci ‚Äì Physics: Energy & Electricity": [
        { front: "Energy stores", back: "Chemical, kinetic, gravitational potential, elastic, thermal, nuclear, magnetic, electrostatic." },
        { front: "Conservation of energy", back: "Energy cannot be created or destroyed, only transferred between stores." },
        { front: "Efficiency", back: "Efficiency = useful output energy √∑ total input energy (√ó 100%)." },
        { front: "Power", back: "Power (W) = energy transferred (J) √∑ time (s). Tells you how quickly energy is transferred." },
        { front: "Series vs parallel circuits", back: "Series: one loop, same current everywhere. Parallel: branches, current splits, components independently controlled." },
        { front: "Ohm's law", back: "For a resistor at constant temperature: V = I √ó R (voltage = current √ó resistance)." },
        { front: "Mains electricity (UK)", back: "Alternating current (a.c.), about 230 V, frequency 50 Hz." }
      ],

      "Sci ‚Äì Physics: Forces & Waves": [
        { front: "Scalar vs vector", back: "Scalar has size only (speed, mass). Vector has size and direction (velocity, force)." },
        { front: "Weight equation", back: "Weight (N) = mass (kg) √ó gravitational field strength (N/kg). On Earth g ‚âà 9.8 N/kg (often 10 N/kg in GCSE)." },
        { front: "Hooke's law (basic)", back: "Extension of a spring is directly proportional to the force up to the limit of proportionality." },
        { front: "Speed", back: "Speed (m/s) = distance (m) √∑ time (s). On distance‚Äìtime graphs, gradient = speed." },
        { front: "Transverse vs longitudinal waves", back: "Transverse: oscillations at 90¬∞ to direction of travel (light, water waves). Longitudinal: oscillations parallel (sound)." },
        { front: "Wave equation", back: "Wave speed v (m/s) = frequency f (Hz) √ó wavelength Œª (m)." }
      ]
    };

    const DECK_SOURCE_SCI = {
      "Sci ‚Äì Biology: Cells & Organisation": "Science",
      "Sci ‚Äì Biology: Health & Disease": "Science",
      "Sci ‚Äì Chemistry: Atoms & Bonding": "Science",
      "Sci ‚Äì Chemistry: Reactions & Energy": "Science",
      "Sci ‚Äì Physics: Energy & Electricity": "Science",
      "Sci ‚Äì Physics: Forces & Waves": "Science"
    };

    function getActiveDecks() {
      return currentSubject === "english" ? DECKS_EN : DECKS_SCI;
    }

    function getActiveSourceMap() {
      return currentSubject === "english" ? DECK_SOURCE_EN : DECK_SOURCE_SCI;
    }

    // ---------- SEARCH INDEX ----------
    const ALL_DECKS = { english: DECKS_EN, science: DECKS_SCI };
    const ALL_DECK_SOURCES = { english: DECK_SOURCE_EN, science: DECK_SOURCE_SCI };
    const QUOTE_INDEX = [];

    Object.entries(ALL_DECKS).forEach(([subject, decks]) => {
      const sourceMap = ALL_DECK_SOURCES[subject] || {};
      Object.entries(decks).forEach(([deckName, cards]) => {
        const source = sourceMap[deckName] || (subject === "science" ? "Science" : "Other");
        cards.forEach(card => {
          const text = `${card.front} ${card.back}`.trim();
          QUOTE_INDEX.push({ text, source, deck: deckName, subject });
        });
      });
    });

    function searchQuotes(term, scope = "all") {
      const q = term.trim().toLowerCase();
      if (!q) return [];
      return QUOTE_INDEX.filter(item => {
        if (scope !== "all" && item.source !== scope) return false;
        return item.text.toLowerCase().includes(q);
      });
    }

    // ---------- FLASHCARDS ----------
    const deckSelectEl = document.getElementById("deck-select");
    const deckInfoEl = document.getElementById("deck-info");
    const deckNameLabelEl = document.getElementById("deck-name-label");
    const cardTextEl = document.getElementById("card-text");
    const cardSideLabelEl = document.getElementById("card-side-label");
    const cardMetaEl = document.getElementById("card-meta");
    const cardPositionEl = document.getElementById("card-position");
    const progressFillEl = document.getElementById("progress-fill");
    const statusEl = document.getElementById("fc-status");
    const studyCardEl = document.getElementById("study-card");
    const shuffleToggleEl = document.getElementById("fc-shuffle");

    let currentDeckName = Object.keys(DECKS_EN)[0] || null;
    let studyOrder = [];
    let currentStudyIndex = 0;
    let showingFront = true;

    function renderDeckOptions() {
      const decks = getActiveDecks();
      deckSelectEl.innerHTML = "";
      const names = Object.keys(decks);
      names.forEach(name => {
        const opt = document.createElement("option");
        opt.value = name;
        opt.textContent = name;
        deckSelectEl.appendChild(opt);
      });
      if (!names.length) {
        currentDeckName = null;
      } else if (!currentDeckName || !decks[currentDeckName]) {
        currentDeckName = names[0];
      }
      if (currentDeckName) {
        deckSelectEl.value = currentDeckName;
      }
      renderDeckInfo();
    }

    function renderDeckInfo() {
      const decks = getActiveDecks();
      const cards = decks[currentDeckName] || [];
      deckInfoEl.textContent = `${cards.length} card${cards.length === 1 ? "" : "s"}`;
      deckNameLabelEl.textContent = currentDeckName || "‚Äî";
    }

    function buildStudyOrder() {
      const decks = getActiveDecks();
      const cards = decks[currentDeckName] || [];
      studyOrder = cards.map((_, i) => i);
      if (shuffleToggleEl.checked) {
        for (let i = studyOrder.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [studyOrder[i], studyOrder[j]] = [studyOrder[j], studyOrder[i]];
        }
      }
    }

    function resetStudyOrder() {
      const decks = getActiveDecks();
      const cards = decks[currentDeckName] || [];
      buildStudyOrder();
      currentStudyIndex = 0;
      showingFront = true;
      refreshStudyState();
    }

    function refreshStudyState() {
      const decks = getActiveDecks();
      const cards = decks[currentDeckName] || [];
      renderDeckInfo();

      if (!cards.length) {
        cardTextEl.textContent = "No cards yet in this deck.";
        cardTextEl.classList.add("empty");
        cardSideLabelEl.textContent = "Front ¬∑ Question";
        cardMetaEl.textContent = "";
        cardPositionEl.textContent = "0 / 0";
        progressFillEl.style.width = "0%";
        statusEl.textContent = "";
        return;
      }

      if (!studyOrder.length || studyOrder.length !== cards.length) {
        buildStudyOrder();
      }

      if (currentStudyIndex < 0) currentStudyIndex = 0;
      if (currentStudyIndex >= studyOrder.length) currentStudyIndex = studyOrder.length - 1;

      const cardIndex = studyOrder[currentStudyIndex];
      const card = cards[cardIndex];

      const text = showingFront ? card.front : card.back;
      cardTextEl.textContent = text || "(empty)";
      cardTextEl.classList.toggle("empty", !text);

      cardSideLabelEl.textContent = showingFront ? "Front ¬∑ Question" : "Back ¬∑ Answer";
      cardMetaEl.textContent = `Card ${cardIndex + 1}`;
      cardPositionEl.textContent = `${currentStudyIndex + 1} / ${cards.length}`;

      const progress = ((currentStudyIndex + 1) / cards.length) * 100;
      progressFillEl.style.width = `${progress}%`;

      const subjectLabel = currentSubject === "english" ? "English" : "Science";
      statusEl.textContent = `${subjectLabel} ¬∑ ${currentDeckName}`;
    }

    function flipCard() {
      const decks = getActiveDecks();
      const cards = decks[currentDeckName] || [];
      if (!cards.length) return;
      showingFront = !showingFront;
      refreshStudyState();
    }

    function moveCard(delta) {
      const decks = getActiveDecks();
      const cards = decks[currentDeckName] || [];
      if (!cards.length) return;
      currentStudyIndex += delta;
      if (currentStudyIndex < 0) currentStudyIndex = cards.length - 1;
      if (currentStudyIndex >= cards.length) currentStudyIndex = 0;
      showingFront = true;
      refreshStudyState();
    }

    function switchToDeck(name) {
      const decks = getActiveDecks();
      if (!decks[name]) return;
      currentDeckName = name;
      deckSelectEl.value = currentDeckName;
      resetStudyOrder();
    }

    deckSelectEl.addEventListener("change", () => {
      currentDeckName = deckSelectEl.value;
      resetStudyOrder();
    });
    document.getElementById("fc-restart").addEventListener("click", resetStudyOrder);
    document.getElementById("fc-prev").addEventListener("click", () => moveCard(-1));
    document.getElementById("fc-next").addEventListener("click", () => moveCard(1));
    document.getElementById("fc-flip").addEventListener("click", flipCard);
    shuffleToggleEl.addEventListener("change", resetStudyOrder);
    studyCardEl.addEventListener("click", flipCard);

    document.querySelectorAll("[data-quick-deck]").forEach(btn => {
      btn.addEventListener("click", () => {
        const name = btn.getAttribute("data-quick-deck");
        if (currentSubject !== "english") setSubject("english");
        switchToDeck(name);
        setView("flashcards");
      });
    });

    renderDeckOptions();
    resetStudyOrder();

    // ---------- GLOBAL SEARCH ----------
    const globalSearchBtn = document.getElementById("global-search-btn");
    const globalSearchPanel = document.getElementById("global-search-panel");
    const searchTitle = document.getElementById("search-title");
    const searchResults = document.getElementById("search-results");
    const searchClear = document.getElementById("search-clear");

    function renderGlobalResults(term) {
      const results = searchQuotes(term, "all");
      searchResults.innerHTML = "";
      if (!term.trim()) {
        globalSearchPanel.classList.remove("active");
        return;
      }

      globalSearchPanel.classList.add("active");
      searchTitle.textContent = `Results for ‚Äú${term.trim()}‚Äù (${results.length})`;

      if (!results.length) {
        const div = document.createElement("div");
        div.className = "muted";
        div.textContent = "No matches found in cards.";
        searchResults.appendChild(div);
        return;
      }

      results.slice(0, 50).forEach(r => {
        const item = document.createElement("div");
        item.className = "search-result-item";
        const snippet =
          r.text.length > 170 ? r.text.slice(0, 170) + "‚Ä¶" : r.text;
        const subjectTag = r.subject === "science" ? "Science" : "English";
        item.innerHTML = `
          <div>${snippet}</div>
          <div class="search-result-meta">${subjectTag} ¬∑ ${r.source} ¬∑ ${r.deck}</div>
        `;
        item.addEventListener("click", () => {
          if (r.subject && r.subject !== currentSubject) {
            setSubject(r.subject);
          }
          switchToDeck(r.deck);
          setView("flashcards");
        });
        searchResults.appendChild(item);
      });
    }

    function doGlobalSearch() {
      const term = globalSearchInput.value;
      renderGlobalResults(term);
    }

    globalSearchBtn.addEventListener("click", doGlobalSearch);
    globalSearchInput.addEventListener("keydown", e => {
      if (e.key === "Enter") {
        e.preventDefault();
        doGlobalSearch();
      }
    });
    searchClear.addEventListener("click", () => {
      globalSearchInput.value = "";
      globalSearchPanel.classList.remove("active");
    });

    // ---------- TOOL TOGGLES ----------
    document.querySelectorAll("[data-toggle]").forEach(btn => {
      const targetSel = btn.getAttribute("data-toggle");
      const closedLabel = btn.getAttribute("data-closed") || "Open";
      const openLabel = btn.getAttribute("data-open") || "Close";
      const target = document.querySelector(targetSel);
      if (!target) return;
      btn.textContent = closedLabel;
      btn.addEventListener("click", () => {
        const open = target.classList.toggle("open");
        btn.textContent = open ? openLabel : closedLabel;
      });
    });

    // ---------- QUOTE FINDER TOOL ----------
    const quoteSearchInput = document.getElementById("quote-search-input");
    const quoteScope = document.getElementById("quote-scope");
    const quoteSearchBtn = document.getElementById("quote-search-btn");
    const quoteClearBtn = document.getElementById("quote-clear-btn");
    const quoteResults = document.getElementById("quote-results");

    function doQuoteSearch() {
      const term = quoteSearchInput.value;
      const scope = quoteScope.value;
      const results = searchQuotes(term, scope);
      quoteResults.innerHTML = "";
      if (!term.trim()) {
        return;
      }
      if (!results.length) {
        const div = document.createElement("div");
        div.className = "mini-label";
        div.textContent = "No matches found.";
        quoteResults.appendChild(div);
        return;
      }
      results.slice(0, 30).forEach(r => {
        const div = document.createElement("div");
        div.className = "quote-result";
        const snippet =
          r.text.length > 160 ? r.text.slice(0, 160) + "‚Ä¶" : r.text;
        const subjectTag = r.subject === "science" ? "Science" : "English";
        div.innerHTML = `
          <div>${snippet}</div>
          <div class="quote-result-source">${subjectTag} ¬∑ ${r.source} ¬∑ ${r.deck}</div>
        `;
        quoteResults.appendChild(div);
      });
    }

    quoteSearchBtn.addEventListener("click", doQuoteSearch);
    quoteSearchInput.addEventListener("keydown", e => {
      if (e.key === "Enter") {
        e.preventDefault();
        doQuoteSearch();
      }
    });
    quoteClearBtn.addEventListener("click", () => {
      quoteSearchInput.value = "";
      quoteResults.innerHTML = "";
    });

    // ---------- PARAGRAPH BUILDER ----------
    const builderTypeEl = document.getElementById("builder-type");
    const builderPointEl = document.getElementById("builder-point");
    const builderEvidenceEl = document.getElementById("builder-evidence");
    const builderTechniqueEl = document.getElementById("builder-technique");
    const builderEffectEl = document.getElementById("builder-effect");
    const builderContextEl = document.getElementById("builder-context");
    const builderGenerateBtn = document.getElementById("builder-generate");
    const builderClearBtn = document.getElementById("builder-clear");
    const builderOutputEl = document.getElementById("builder-output");

    function buildParagraph() {
      const type = builderTypeEl.value;
      const P = builderPointEl.value.trim();
      const E = builderEvidenceEl.value.trim();
      const T = builderTechniqueEl.value.trim();
      const F = builderEffectEl.value.trim();
      const C = builderContextEl.value.trim();

      if (!P && !E) {
        builderOutputEl.textContent = "Add at least a point and a quote.";
        return;
      }

      let paragraph = "";

      if (type === "lang") {
        paragraph = `${P} This is shown in the quotation ${E}. The use of ${T} helps to create this because ${F}. Overall, the writer makes the reader ${F || "respond in a particular way"} by focusing on this detail.`;
      } else if (type === "lit") {
        paragraph = `The writer presents ${P} This is evident in the quotation ${E}. The use of ${T} suggests ${F}. This is notable in the context of ${C || "the time the text was produced"}, and the writer may be trying to show that ${F || "this behaviour has serious consequences"}.`;
      } else if (type === "poetry") {
        paragraph = `${P} In the first poem, this is shown in the quotation ${E}, where the use of ${T} makes the reader ${F}. In the context of ${C || "the poet‚Äôs background"}, this suggests a wider message about the theme. You could then compare how the second poem uses a different method to present a similar or contrasting idea.`;
      } else if (type === "tx") {
        paragraph = `${P} For example, ${E}. The use of ${T} helps to convince the reader because ${F}. More widely, this supports the view that ${C || "this issue needs to be taken seriously by everyone"}.`;
      } else {
        paragraph = `${P} ${E} ${T} ${F} ${C}`;
      }

      builderOutputEl.textContent = paragraph.trim();
    }

    builderGenerateBtn.addEventListener("click", buildParagraph);
    builderClearBtn.addEventListener("click", () => {
      builderPointEl.value = "";
      builderEvidenceEl.value = "";
      builderTechniqueEl.value = "";
      builderEffectEl.value = "";
      builderContextEl.value = "";
      builderOutputEl.textContent = "";
    });

    // ---------- RANDOM QUESTIONS ----------
    const QUESTION_SETS = {
      "lang-p1": [
        "Write the opening to a story where a character returns to a place from their childhood that now feels completely different.",
        "Describe a stormy night in a city, focusing on how the weather affects the people who live there.",
        "Explain how a writer presents a character‚Äôs fear of change in a 19th-century extract."
      ],
      "lang-p2": [
        "Write an article arguing that mobile phones should be banned for under-16s.",
        "Write a speech to your year group about the importance of sleep for teenagers.",
        "Compare how two writers present strong opinions about education in non-fiction texts."
      ],
      "acc": [
        "How does Dickens present Scrooge as an outsider in A Christmas Carol?",
        "How does Dickens present the Cratchit family in the novella?",
        "How does Dickens show the importance of memory and the past in A Christmas Carol?"
      ],
      "macbeth": [
        "How does Shakespeare present Macbeth as a tragic hero?",
        "How does Shakespeare present the theme of ambition in Macbeth?",
        "How does Shakespeare present guilt in Macbeth?"
      ],
      "aic": [
        "How does Priestley present Arthur Birling in An Inspector Calls?",
        "How does Priestley present the younger generation in An Inspector Calls?",
        "How does Priestley explore social responsibility in An Inspector Calls?"
      ],
      "belonging": [
        "Compare how belonging to a place is presented in Island Man and one other poem of your choice.",
        "Compare how childhood is presented in Sunday Dip and one other poem of your choice.",
        "Compare how dual identity is presented in Jamaican British and one other poem of your choice."
      ],
      "unseen": [
        "Compare how two unseen poems present different attitudes towards nature.",
        "Compare how two unseen poems present different views about growing up.",
        "Compare how two unseen poems present people feeling out of place."
      ],
      "science": [
        "Explain the difference between diffusion, osmosis and active transport, giving one example of each.",
        "Describe the structure of an atom and explain what is meant by an isotope.",
        "Compare series and parallel circuits and explain when each might be useful.",
        "Explain the difference between exothermic and endothermic reactions, with one example of each.",
        "Describe how vaccination helps to protect people from infectious disease.",
        "Explain the difference between transverse and longitudinal waves, giving one example of each."
      ]
    };

    const questionOutputEl = document.getElementById("question-output");
    document.querySelectorAll("[data-qset]").forEach(btn => {
      btn.addEventListener("click", () => {
        const key = btn.getAttribute("data-qset");
        const arr = QUESTION_SETS[key] || [];
        if (!arr.length) {
          questionOutputEl.textContent = "No questions stored for this set yet.";
          return;
        }
        const q = arr[Math.floor(Math.random() * arr.length)];
        questionOutputEl.textContent = q;
      });
    });

    // ---------- TIMER ----------
    const timerDisplay = document.getElementById("timer-display");
    const timerStartBtn = document.getElementById("timer-start");
    const timerResetBtn = document.getElementById("timer-reset");
    let timerSecondsDefault = 25 * 60;
    let timerSeconds = timerSecondsDefault;
    let timerInterval = null;

    function renderTimer() {
      const mins = Math.floor(timerSeconds / 60);
      const secs = timerSeconds % 60;
      const mm = String(mins).padStart(2, "0");
      const ss = String(secs).padStart(2, "0");
      timerDisplay.textContent = `${mm}:${ss}`;
    }

    function startTimer() {
      if (timerInterval) return;
      timerInterval = setInterval(() => {
        timerSeconds--;
        if (timerSeconds <= 0) {
          timerSeconds = 0;
          clearInterval(timerInterval);
          timerInterval = null;
        }
        renderTimer();
      }, 1000);
    }

    function resetTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
      timerSeconds = timerSecondsDefault;
      renderTimer();
    }

    timerStartBtn.addEventListener("click", startTimer);
    timerResetBtn.addEventListener("click", resetTimer);
    renderTimer();

    // set starting subject UI (english)
    updateSubjectSections();
    // start on home
    setView("home");
  </script>
</body>
</html>